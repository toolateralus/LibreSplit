<UserControl xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:timing="clr-namespace:LibreSplit.Timing"
  xmlns:ls="clr-namespace:LibreSplit"
  xmlns:local="clr-namespace:LibreSplit.Layouts.SplitsLayout"
  x:Class="LibreSplit.Layouts.SplitsLayout.SplitsControl"
  x:DataType="local:SplitsViewModel">
  <UserControl.Styles>
    <Style Selector="Grid.Active">
      <Setter Property="Background"
        Value="{Binding $parent[local:SplitsControl].ViewModel.LayoutItem.ActiveSplitColor}" />
    </Style>
    <Style Selector="Grid.Inactive">
      <Setter Property="Background"
        Value="{Binding $parent[local:SplitsControl].ViewModel.LayoutItem.InactiveSplitColor}" />
    </Style>
  </UserControl.Styles>
  <ItemsControl ItemsSource="{Binding SegmentViewModels}">
    <ItemsControl.DataTemplates>
      <DataTemplate x:DataType="local:SegmentViewModel">
        <Border BorderThickness="0 0 0 1" BorderBrush="Gray" Margin="0,0,0,1">
          <Grid
            Classes.Active="{Binding IsActive}"
            Classes.Inactive="{Binding !IsActive}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="{Binding Segment.Label}"
              HorizontalAlignment="Left" Foreground="White" Margin="10,0,10,0" />
            <ItemsControl ItemsSource="{Binding Comparisons}" Grid.Column="1" Margin="10,0,10,0">
              <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="local:ComparisonViewModel">
                  <TextBlock TextAlignment="Right" Width="75"
                    Text="{Binding TimeString}" ls:Setters.Classes="{Binding Classes}" />
                </DataTemplate>
              </ItemsControl.ItemTemplate>
              <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                  <StackPanel Orientation="Horizontal" />
                </ItemsPanelTemplate>
              </ItemsControl.ItemsPanel>
            </ItemsControl>
          </Grid>
        </Border>
      </DataTemplate>
      <DataTemplate x:DataType="local:EmptySegmentViewModel">
        <Border BorderThickness="0 0 0 1" BorderBrush="Gray" Margin="0,0,0,1">
          <Grid>
            <TextBlock />
          </Grid>
        </Border>
      </DataTemplate>
    </ItemsControl.DataTemplates>
  </ItemsControl>
</UserControl>